<dashboard theme="dark">
  <label>BlackCat Vulnerabilities</label>
  <description>Github Dependency Vulnerabilities</description>
  <row>
    <panel>
      <chart>
        <title>Vulnerabilities By Generic Severity</title>
        <search>
          <query>index="blackcat"  | spath run_id  | eventstats max(run_id) as MaxRunId   | where run_id=MaxRunId  | eval dismissed_reason=if(isnull(dismissed_reason),"",dismissed_reason)| search dismissed_reason!="Vulnerable code is not actually used" | spath severity | fields + severity| top limit=5 severity</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.rangeValues">[0,30,70,100]</option>
        <option name="charting.chart.style">minimal</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.gaugeColors">["0x53a051","0xf8be34","0xdc4e41"]</option>
        <option name="charting.legend.placement">right</option>
        <option name="height">385</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
      </chart>
    </panel>
    <panel>
      <chart>
        <title>Open Dependency Vulnerabilities Count by Repo (Top Ten)</title>
        <search>
          <query>index="blackcat"  | spath run_id  | eventstats max(run_id) as MaxRunId   | where run_id=MaxRunId  | eval dismissed_reason=if(isnull(dismissed_reason),"",dismissed_reason)| search dismissed_reason!="Vulnerable code is not actually used" |spath severity  | spath repo_url | fields + repo_url severity | eval repo=substr(repo_url, 20) |top repo limit=20 by severity |rename count as "Open Vulnerabilities"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="charting.axisTitleX.visibility">collapsed</option>
        <option name="charting.axisTitleY.visibility">collapsed</option>
        <option name="charting.axisTitleY2.visibility">collapsed</option>
        <option name="charting.chart">column</option>
        <option name="charting.chart.showDataLabels">all</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.015</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.seriesColors">[0xFF0000]</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.placement">none</option>
        <option name="height">386</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">1</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Generic Severity Per Run</title>
        <search>
          <query>index="blackcat"  | eval dismissed_reason=if(isnull(dismissed_reason),"",dismissed_reason)| search dismissed_reason!="Vulnerable code is not actually used" | spath run_id| spath severity | fields + severity run_id |chart count(severity) as "Open Vulnerabilities" over run_id by "severity" | fieldformat run_id = strftime(run_id, "%Y-%m-%d %H:%M:%S UTC") |sort -"Open Vulnerabilities"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="charting.axisTitleX.text">Run Date</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.legend.placement">right</option>
        <option name="height">381</option>
        <option name="refresh.display">progressbar</option>
        <option name="trellis.enabled">0</option>
      </chart>
    </panel>
    <panel>
      <table>
        <title>Most Vulnerable Repos</title>
        <search>
          <query>index="blackcat"  | spath run_id  | eventstats max(run_id) as MaxRunId   | where run_id=MaxRunId  | eval dismissed_reason=if(isnull(dismissed_reason),"",dismissed_reason)| search dismissed_reason!="Vulnerable code is not actually used"  | spath repo_url | fields + repo_url | eval repo=substr(repo_url, 20) |stats count(repo_url) as "Open Vulnerabilities" by repo |sort -"Open Vulnerabilities"</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="count">10</option>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>Vulnerabilities By Packages Per Run</title>
        <search>
          <query>index="blackcat"| eval dismissed_reason=if(isnull(dismissed_reason),"",dismissed_reason)| search dismissed_reason!="Vulnerable code is not actually used" | spath run_id| spath "package.name" | fields + "package.name" run_id |chart count("package.name") as "Open Vulnerabilities" over run_id by "package.name" | fieldformat run_id = strftime(run_id, "%Y-%m-%d %H:%M:%S UTC")</query>
          <earliest>0</earliest>
          <latest></latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.text">Run Date</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">minmax</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="height">268</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
</dashboard>